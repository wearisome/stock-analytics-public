<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weekly Screening Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f6f4ef;
      --ink: #222222;
      --accent: #0f766e;
      --muted: #6b7280;
      --card: #ffffff;
      --border: #e4e2dd;
    }
    body {
      margin: 0;
      font-family: "Noto Sans JP", "Hiragino Sans", "Yu Gothic", sans-serif;
      background: radial-gradient(circle at top, #fef7e8 0%, #f6f4ef 45%, #eef1f6 100%);
      color: var(--ink);
    }
    header {
      padding: 32px 24px 16px;
      max-width: 1100px;
      margin: 0 auto;
    }
    h1 {
      margin: 0 0 8px;
      font-size: 28px;
      letter-spacing: 0.02em;
    }
    .sub {
      color: var(--muted);
      font-size: 14px;
    }
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px 32px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }
    .summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.08);
    }
    .card h3 {
      margin: 0 0 8px;
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
    }
    .card .value {
      font-size: 22px;
      font-weight: 700;
    }
    section {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.08);
    }
    section h2 {
      margin: 0 0 16px;
      font-size: 18px;
    }
    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    .table th,
    .table td {
      padding: 8px 10px;
      border-bottom: 1px solid var(--border);
      text-align: left;
    }
    .table th {
      color: var(--muted);
      font-weight: 600;
      background: #f9f7f2;
    }
    .sector-layout {
      display: grid;
      grid-template-columns: 220px 1fr;
      gap: 16px;
      align-items: start;
    }
    .sector-nav {
      position: sticky;
      top: 16px;
      background: #fff7ed;
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 12px;
      max-height: 70vh;
      overflow-y: auto;
    }
    .sector-nav a {
      display: block;
      padding: 6px 8px;
      text-decoration: none;
      color: var(--ink);
      border-radius: 8px;
      font-size: 13px;
    }
    .sector-nav a:hover {
      background: #ffedd5;
    }
    .sector-section {
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 18px;
      background: #ffffff;
    }
    .sector-section h3 {
      margin: 0 0 8px;
      font-size: 16px;
    }
    .sector-meta {
      color: var(--muted);
      font-size: 12px;
      margin-bottom: 12px;
    }
    .metric-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }
    .metric-tab {
      border: 1px solid var(--border);
      background: #f8fafc;
      color: var(--ink);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      cursor: pointer;
    }
    .metric-tab.active {
      background: #0f766e;
      color: #fff;
      border-color: #0f766e;
    }
    .heatmap {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-bottom: 12px;
    }
    .heatmap th,
    .heatmap td {
      padding: 8px;
      text-align: center;
      border: 1px solid var(--border);
    }
    .heatmap td {
      font-weight: 600;
    }
    .heatmap td.highlight {
      outline: 3px solid #f97316;
      outline-offset: -2px;
    }
    .ranking-table tr.selected {
      background: #fff7ed;
    }
    footer {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 12px;
    }
    @media (max-width: 640px) {
      h1 { font-size: 22px; }
      section { padding: 16px; }
    }
    @media (max-width: 960px) {
      .sector-layout {
        grid-template-columns: 1fr;
      }
      .sector-nav {
        position: static;
        max-height: none;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Weekly Screening Dashboard</h1>
    <div class="sub">Generated at: 2026-02-24 20:23:55</div>
  </header>
  <main>
    <div class="summary">
      <div class="card">
        <h3>Runs</h3>
        <div class="value">3</div>
      </div>
      <div class="card">
        <h3>Last run</h3>
        <div class="value">2026-02-24</div>
      </div>
      <div class="card">
        <h3>Last candidates</h3>
        <div class="value">10</div>
      </div>
      <div class="card">
        <h3>Last recommendations</h3>
        <div class="value">84</div>
      </div>
    </div>

    <section>
      <h2>Weekly candidates trend</h2>
      <canvas id="candidatesChart" height="120"></canvas>
    </section>

    <section>
      <h2>Return summary</h2>
      <canvas id="returnsChart" height="120"></canvas>
    </section>

    <section>
      <h2>Grade performance (matured -)</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Grade</th>
            <th>Count</th>
            <th>Avg return</th>
            <th>Median return</th>
            <th>Win rate</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan='5'>No matured data</td></tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Latest candidates</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Grade</th>
            <th>Ticker</th>
            <th>Name</th>
            <th>Sector</th>
            <th>Price</th>
            <th>Target</th>
            <th>Upside</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>B</td><td>9405.T</td><td>朝日放送グループホールディングス</td><td>情報・通信業</td><td>826.00</td><td>3256.56</td><td>294.26%</td><td>70.11</td></tr><tr><td>2</td><td>B</td><td>4341.T</td><td>西菱電機</td><td>サービス業</td><td>932.00</td><td>2303.72</td><td>147.18%</td><td>69.18</td></tr><tr><td>3</td><td>B</td><td>3856.T</td><td>Ａｂａｌａｎｃｅ</td><td>電気機器</td><td>489.00</td><td>5062.67</td><td>935.31%</td><td>65.87</td></tr><tr><td>4</td><td>B</td><td>4404.T</td><td>ミヨシ油脂</td><td>食料品</td><td>2305.00</td><td>11085.48</td><td>380.93%</td><td>65.75</td></tr><tr><td>5</td><td>B</td><td>6059.T</td><td>ウチヤマホールディングス</td><td>サービス業</td><td>391.00</td><td>1490.39</td><td>281.17%</td><td>65.40</td></tr><tr><td>6</td><td>B</td><td>3280.T</td><td>エストラスト</td><td>不動産業</td><td>1159.00</td><td>3322.54</td><td>186.67%</td><td>65.31</td></tr><tr><td>7</td><td>B</td><td>3768.T</td><td>リスクモンスター</td><td>情報・通信業</td><td>561.00</td><td>2392.61</td><td>326.49%</td><td>65.23</td></tr><tr><td>8</td><td>B</td><td>4222.T</td><td>児玉化学工業</td><td>化学</td><td>1411.00</td><td>13699.32</td><td>870.89%</td><td>64.57</td></tr><tr><td>9</td><td>B</td><td>3551.T</td><td>ダイニック</td><td>繊維製品</td><td>1230.00</td><td>3528.74</td><td>186.89%</td><td>64.25</td></tr><tr><td>10</td><td>B</td><td>4569.T</td><td>杏林製薬</td><td>医薬品</td><td>1687.00</td><td>3355.39</td><td>98.90%</td><td>63.50</td></tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Sector dashboards</h2>
      <div class="sector-layout">
        <nav class="sector-nav" id="sectorNav"></nav>
        <div class="sector-content" id="sectorSections"></div>
      </div>
    </section>
  </main>
  <footer>Stock Analytics Dashboard</footer>

  <script>
    const timeseries = [{"date": "2026-02-22", "total_candidates": 10, "total_recommendations": 84, "total_scored_stocks": 2578}, {"date": "2026-02-23", "total_candidates": 10, "total_recommendations": 84, "total_scored_stocks": 2578}, {"date": "2026-02-24", "total_candidates": 10, "total_recommendations": 84, "total_scored_stocks": 2578}];
    const returnSummary = [{"horizon": "4w", "count": 0, "avg": null, "median": null, "win_rate": null}, {"horizon": "12w", "count": 0, "avg": null, "median": null, "win_rate": null}, {"horizon": "26w", "count": 0, "avg": null, "median": null, "win_rate": null}];
    const sectorPages = [{"sector": "その他製品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 16.128778337531486, "pbr_median": 0.436971313227819, "psr_median": 23.6428997430106}, {"label": "2,000-1兆", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "1兆以上", "count": 37, "per_median": 18.28063241106719, "pbr_median": 1.2804065661621666, "psr_median": 103.85192609870592}], "rankings": [{"rank": 29, "grade": "C", "ticker": "5962.T", "company_name": "浅香工業", "price": 2049.0, "per": 16.128778337531486, "pbr": 0.436971313227819, "psr": 23.6428997430106, "final_score": 55.12, "size_bucket": "500-2,000億"}, {"rank": 64, "grade": "C", "ticker": "7990.T", "company_name": "グローブライド", "price": 2310.0, "per": 9.86210135337062, "pbr": 0.81909549164168, "psr": 40.21078114944886, "final_score": 42.25, "size_bucket": "1兆以上"}, {"rank": 67, "grade": "C", "ticker": "7914.T", "company_name": "共同印刷", "price": 1668.0, "per": 12.530989407257154, "pbr": 0.7152327422229159, "psr": 47.15208013926407, "final_score": 41.44, "size_bucket": "1兆以上"}]}, {"sector": "その他金融業", "buckets": [{"label": "0-500億", "count": 1, "per_median": 13.586739979281218, "pbr_median": 3.0787065459982235, "psr_median": 0.057164887976271}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 3, "per_median": 14.492832025967, "pbr_median": 2.346685431298875, "psr_median": 159.9205480701754}, {"label": "1兆以上", "count": 20, "per_median": 14.471584878321059, "pbr_median": 1.0781811475311427, "psr_median": 110.87057574045876}], "rankings": [{"rank": 62, "grade": "C", "ticker": "8425.T", "company_name": "みずほリース", "price": 1509.0, "per": 9.345968041620216, "pbr": 1.0227942821122835, "psr": 48.35685686603602, "final_score": 42.41, "size_bucket": "1兆以上"}, {"rank": 70, "grade": "C", "ticker": "8584.T", "company_name": "ジャックス", "price": 4290.0, "per": 8.857414213156048, "pbr": 0.6553025894075606, "psr": 99.34377925684994, "final_score": 38.69, "size_bucket": "1兆以上"}, {"rank": 75, "grade": "C", "ticker": "8793.T", "company_name": "ＮＥＣキャピタルソリューション", "price": 4250.0, "per": 11.834154762899228, "pbr": 0.7309336809252623, "psr": 33.62461021225362, "final_score": 35.24, "size_bucket": "1兆以上"}]}, {"sector": "ガラス・土石製品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 2, "per_median": 1043.183652875883, "pbr_median": 0.8295214547429375, "psr_median": 22.760656301810535}, {"label": "2,000-1兆", "count": 7, "per_median": 15.38368287065099, "pbr_median": 0.7570698572317481, "psr_median": 43.08261131278101}, {"label": "1兆以上", "count": 42, "per_median": 16.142036023252135, "pbr_median": 0.9955676954812098, "psr_median": 95.65107547440502}], "rankings": [{"rank": 11, "grade": "B", "ticker": "5204.T", "company_name": "石塚硝子", "price": 3920.0, "per": 5.596002855103498, "pbr": 0.4483630972465244, "psr": 28.103968876080117, "final_score": 62.48, "size_bucket": "1兆以上"}, {"rank": 32, "grade": "C", "ticker": "5279.T", "company_name": "日本興業", "price": 1489.0, "per": 8.12329514457174, "pbr": 0.5275767820863412, "psr": 26.7267849412588, "final_score": 54.01, "size_bucket": "2,000-1兆"}, {"rank": 83, "grade": "C", "ticker": "5380.T", "company_name": "新東", "price": 1622.0, "per": 16.367305751765894, "pbr": 0.346798464337059, "psr": 12.856808083325868, "final_score": 30.88, "size_bucket": "500-2,000億"}]}, {"sector": "ゴム製品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 5, "per_median": 450.0, "pbr_median": 0.6762366828389936, "psr_median": 41.680661252078266}, {"label": "1兆以上", "count": 12, "per_median": 14.370804465482175, "pbr_median": 1.1166010368520254, "psr_median": 103.12869904395725}], "rankings": [{"rank": 35, "grade": "C", "ticker": "5189.T", "company_name": "櫻護謨", "price": 3120.0, "per": 9.597047062442323, "pbr": 0.6455013932071736, "psr": 44.64888852745781, "final_score": 53.11, "size_bucket": "2,000-1兆"}, {"rank": 52, "grade": "C", "ticker": "5199.T", "company_name": "不二ラテックス", "price": 2049.0, "per": 9.35445580715851, "pbr": 0.6388903699671014, "psr": 38.12526511155786, "final_score": 46.33, "size_bucket": "2,000-1兆"}, {"rank": 69, "grade": "C", "ticker": "5185.T", "company_name": "フコク", "price": 2005.0, "per": 13.831401766004417, "pbr": 0.7230733611118524, "psr": 31.762978266943037, "final_score": 39.06, "size_bucket": "1兆以上"}]}, {"sector": "サービス業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 7, "per_median": 18.731117824773413, "pbr_median": 0.8596035364677812, "psr_median": 70.44530581696245}, {"label": "2,000-1兆", "count": 88, "per_median": 16.9807562276968, "pbr_median": 1.247930432508235, "psr_median": 51.356806168422324}, {"label": "1兆以上", "count": 191, "per_median": 16.260395755663897, "pbr_median": 1.9577761768795727, "psr_median": 105.99961744643213}], "rankings": [{"rank": 2, "grade": "B", "ticker": "4341.T", "company_name": "西菱電機", "price": 932.0, "per": 7.479335526843752, "pbr": 0.5697639942167732, "psr": 15.204800996491576, "final_score": 69.18, "size_bucket": "2,000-1兆"}, {"rank": 5, "grade": "B", "ticker": "6059.T", "company_name": "ウチヤマホールディングス", "price": 391.0, "per": 3.55002723806065, "pbr": 0.5203093645039895, "psr": 25.690379468506567, "final_score": 65.4, "size_bucket": "2,000-1兆"}, {"rank": 13, "grade": "B", "ticker": "4331.T", "company_name": "テイクアンドギヴ・ニーズ", "price": 713.0, "per": 3.9872497483502967, "pbr": 0.58665262430371, "psr": 21.71075349224789, "final_score": 60.96, "size_bucket": "1兆以上"}]}, {"sector": "パルプ・紙", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 9, "per_median": 11.4941095805024, "pbr_median": 0.6203605425126957, "psr_median": 26.251871598922577}, {"label": "1兆以上", "count": 15, "per_median": 13.6986301369863, "pbr_median": 0.6049985310138408, "psr_median": 40.63003010116935}], "rankings": [{"rank": 47, "grade": "C", "ticker": "3945.T", "company_name": "スーパーバッグ", "price": 2642.0, "per": 4.060118023112859, "pbr": 0.7610025647111417, "psr": 13.986741717949396, "final_score": 47.53, "size_bucket": "2,000-1兆"}, {"rank": 56, "grade": "C", "ticker": "3944.T", "company_name": "古林紙工", "price": 2705.0, "per": 8.354180178510763, "pbr": 0.3001762661667946, "psr": 16.7990711375814, "final_score": 44.16, "size_bucket": "2,000-1兆"}, {"rank": 68, "grade": "C", "ticker": "3863.T", "company_name": "日本製紙", "price": 1246.0, "per": 8.15018315018315, "pbr": 0.2966805117572153, "psr": 12.140941350249305, "final_score": 39.24, "size_bucket": "1兆以上"}]}, {"sector": "不動産業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 18, "per_median": 9.876960533891925, "pbr_median": 0.7697632593112058, "psr_median": 50.13771514205979}, {"label": "1兆以上", "count": 67, "per_median": 12.165620727132488, "pbr_median": 1.6183574879227052, "psr_median": 89.60266827728022}], "rankings": [{"rank": 6, "grade": "B", "ticker": "3280.T", "company_name": "エストラスト", "price": 1159.0, "per": 3.088360690684289, "pbr": 0.6479888583934684, "psr": 24.546221230531152, "final_score": 65.31, "size_bucket": "2,000-1兆"}, {"rank": 39, "grade": "C", "ticker": "463A.T", "company_name": "インテリックスホールディングス", "price": 1004.0, "per": 4.861514623281038, "pbr": 0.5752404808872913, "psr": 15.503151888550796, "final_score": 51.07, "size_bucket": "2,000-1兆"}, {"rank": 41, "grade": "C", "ticker": "3238.T", "company_name": "セントラル総合開発", "price": 426.0, "per": 7.468443197755961, "pbr": 0.4521361842677835, "psr": 10.233922772122622, "final_score": 50.25, "size_bucket": "2,000-1兆"}]}, {"sector": "保険業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 1, "per_median": 2110.0, "pbr_median": 14.397816444899352, "psr_median": 108.55877912937396}, {"label": "1兆以上", "count": 10, "per_median": 13.547182860550958, "pbr_median": 1.5164284432496289, "psr_median": 91.66979538818805}], "rankings": [{"rank": 63, "grade": "C", "ticker": "8725.T", "company_name": "ＭＳ＆ＡＤインシュアランスグループホールディングス", "price": 4320.0, "per": 8.960610649022007, "pbr": 1.3832126651050023, "psr": 89.61110044339112, "final_score": 42.36, "size_bucket": "1兆以上"}, {"rank": 71, "grade": "C", "ticker": "8729.T", "company_name": "ソニーフィナンシャルグループ", "price": 159.3000030517578, "per": 0.9043429069075096, "pbr": 1.6432167339057375, "psr": 37.38118783977912, "final_score": 36.28, "size_bucket": "1兆以上"}, {"rank": 72, "grade": "C", "ticker": "7181.T", "company_name": "かんぽ生命保険", "price": 4959.0, "per": 12.077153503324322, "pbr": 0.4381493715617997, "psr": 66.59053277894581, "final_score": 36.03, "size_bucket": "1兆以上"}]}, {"sector": "化学", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 2, "per_median": 13.429282823405758, "pbr_median": 0.6109574713731212, "psr_median": 27.863920841099706}, {"label": "2,000-1兆", "count": 35, "per_median": 19.41708810220921, "pbr_median": 0.638880845630931, "psr_median": 45.98285312944523}, {"label": "1兆以上", "count": 152, "per_median": 17.21242087406747, "pbr_median": 1.0562140478383006, "psr_median": 93.51835655910499}], "rankings": [{"rank": 8, "grade": "B", "ticker": "4222.T", "company_name": "児玉化学工業", "price": 1411.0, "per": 0.9644104519947782, "pbr": 0.7725842642490054, "psr": 33.344927770089136, "final_score": 64.57, "size_bucket": "1兆以上"}, {"rank": 21, "grade": "C", "ticker": "6776.T", "company_name": "天昇電気工業", "price": 269.0, "per": 4.5088836741535365, "pbr": 0.4350153387378733, "psr": 19.79388846698459, "final_score": 58.73, "size_bucket": "2,000-1兆"}, {"rank": 54, "grade": "C", "ticker": "4120.T", "company_name": "スガイ化学工業", "price": 2360.0, "per": 6.591994637021313, "pbr": 0.3943371843589832, "psr": 49.80732239493744, "final_score": 45.56, "size_bucket": "2,000-1兆"}]}, {"sector": "医薬品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 6, "per_median": 16.182827492212667, "pbr_median": 1.101892951886438, "psr_median": 85.6839028414919}, {"label": "1兆以上", "count": 35, "per_median": 21.69177921773753, "pbr_median": 1.5278589628902404, "psr_median": 206.623525964905}], "rankings": [{"rank": 10, "grade": "B", "ticker": "4569.T", "company_name": "杏林製薬", "price": 1687.0, "per": 10.394971963768564, "pbr": 0.6978687493794883, "psr": 72.732359306611, "final_score": 63.5, "size_bucket": "1兆以上"}, {"rank": 33, "grade": "C", "ticker": "4553.T", "company_name": "東和薬品", "price": 4310.0, "per": 10.27756581457459, "pbr": 1.118531946284515, "psr": 78.60501989649687, "final_score": 53.98, "size_bucket": "1兆以上"}, {"rank": 36, "grade": "C", "ticker": "4539.T", "company_name": "日本ケミファ", "price": 1800.0, "per": 12.919896640826874, "pbr": 0.3378789312213647, "psr": 19.96964976089977, "final_score": 53.02, "size_bucket": "2,000-1兆"}]}, {"sector": "卸売業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 1790.0, "pbr_median": 13.884579584238288, "psr_median": 836.1364656084655}, {"label": "2,000-1兆", "count": 26, "per_median": 11.721198685083221, "pbr_median": 0.8573309111942938, "psr_median": 23.952192124459152}, {"label": "1兆以上", "count": 143, "per_median": 14.184397163120568, "pbr_median": 1.1262707806946433, "psr_median": 37.44311555456443}], "rankings": [{"rank": 24, "grade": "C", "ticker": "2700.T", "company_name": "木徳神糧", "price": 2057.0, "per": 3.653641207815275, "pbr": 0.8235428356377453, "psr": 9.550139681462117, "final_score": 57.44, "size_bucket": "1兆以上"}, {"rank": 28, "grade": "C", "ticker": "2788.T", "company_name": "アップルインターナショナル", "price": 356.0, "per": 7.326610413665363, "pbr": 0.4452125890112528, "psr": 11.202038855302574, "final_score": 55.62, "size_bucket": "2,000-1兆"}, {"rank": 49, "grade": "C", "ticker": "3417.T", "company_name": "大木ヘルスケアホールディングス", "price": 1341.0, "per": 6.45984874030541, "pbr": 0.5505782714141486, "psr": 5.089824986543448, "final_score": 47.22, "size_bucket": "1兆以上"}]}, {"sector": "小売業", "buckets": [{"label": "0-500億", "count": 1, "per_median": 50500.0, "pbr_median": 2.4318808503589078, "psr_median": 0.0041170211333445}, {"label": "500-2,000億", "count": 5, "per_median": 17.855875044373445, "pbr_median": 2.821929451763706, "psr_median": 34.45922569077462}, {"label": "2,000-1兆", "count": 45, "per_median": 16.778523489932883, "pbr_median": 1.285893513410591, "psr_median": 33.276123910496075}, {"label": "1兆以上", "count": 165, "per_median": 21.23206916879544, "pbr_median": 1.7890139172321076, "psr_median": 64.3131290258533}], "rankings": [{"rank": 18, "grade": "C", "ticker": "3159.T", "company_name": "丸善ＣＨＩホールディングス", "price": 342.0, "per": 8.096590909090908, "pbr": 0.588208989622067, "psr": 17.218907043459417, "final_score": 59.71, "size_bucket": "1兆以上"}, {"rank": 20, "grade": "C", "ticker": "3538.T", "company_name": "ウイルプラスホールディングス", "price": 1046.0, "per": 6.389737324373855, "pbr": 0.8276331353923938, "psr": 10.60647606893503, "final_score": 58.75, "size_bucket": "2,000-1兆"}, {"rank": 43, "grade": "C", "ticker": "3192.T", "company_name": "白鳩", "price": 301.0, "per": 3.830003817279552, "pbr": 0.7950175379284115, "psr": 33.29640324596473, "final_score": 49.18, "size_bucket": "2,000-1兆"}]}, {"sector": "建設業", "buckets": [{"label": "0-500億", "count": 1, "per_median": 46650.0, "pbr_median": 2.0468740744640943, "psr_median": 0.0046107499088996}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 22, "per_median": 13.123567663389029, "pbr_median": 0.7647420092169162, "psr_median": 51.567402451410175}, {"label": "1兆以上", "count": 114, "per_median": 15.711746336698322, "pbr_median": 1.4213631771363606, "psr_median": 73.35924268976683}], "rankings": [{"rank": 38, "grade": "C", "ticker": "1724.T", "company_name": "シンクレイヤ", "price": 738.0, "per": 7.066934788853777, "pbr": 0.5506168326102446, "psr": 31.736693473571023, "final_score": 52.8, "size_bucket": "2,000-1兆"}, {"rank": 46, "grade": "C", "ticker": "1848.T", "company_name": "富士ピー・エス", "price": 638.0, "per": 4.008041211207438, "pbr": 0.8920456928734217, "psr": 34.01288470915263, "final_score": 47.91, "size_bucket": "1兆以上"}, {"rank": 60, "grade": "C", "ticker": "1420.T", "company_name": "サンヨーホームズ", "price": 718.0, "per": 7.47371708129489, "pbr": 0.5483662047559694, "psr": 17.341348400305932, "final_score": 42.87, "size_bucket": "2,000-1兆"}]}, {"sector": "情報・通信業", "buckets": [{"label": "0-500億", "count": 2, "per_median": 57485.0, "pbr_median": 96.10947635925902, "psr_median": 0.0008297147080814501}, {"label": "500-2,000億", "count": 11, "per_median": 103.01810865191148, "pbr_median": 1.227634042291993, "psr_median": 70.34327620037223}, {"label": "2,000-1兆", "count": 97, "per_median": 17.484551072337332, "pbr_median": 1.6526102525442894, "psr_median": 99.86682430059896}, {"label": "1兆以上", "count": 216, "per_median": 17.9700853567832, "pbr_median": 2.44527746683257, "psr_median": 165.11524689690526}], "rankings": [{"rank": 1, "grade": "B", "ticker": "9405.T", "company_name": "朝日放送グループホールディングス", "price": 826.0, "per": 5.988110772799768, "pbr": 0.4273594926321878, "psr": 35.56712937948242, "final_score": 70.11, "size_bucket": "1兆以上"}, {"rank": 7, "grade": "B", "ticker": "3768.T", "company_name": "リスクモンスター", "price": 561.0, "per": 3.2764863917766616, "pbr": 0.6898985812192635, "psr": 111.95528017978098, "final_score": 65.23, "size_bucket": "2,000-1兆"}, {"rank": 23, "grade": "C", "ticker": "3981.T", "company_name": "ビーグリー", "price": 1280.0, "per": 6.988043893650707, "pbr": 0.8871423274317576, "psr": 42.781144497607656, "final_score": 57.72, "size_bucket": "2,000-1兆"}]}, {"sector": "機械", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 3320.0, "pbr_median": 1.3038321669533528, "psr_median": 56.87903193802468}, {"label": "2,000-1兆", "count": 38, "per_median": 13.219863557822741, "pbr_median": 0.6844879015974481, "psr_median": 67.4260411290943}, {"label": "1兆以上", "count": 166, "per_median": 18.082571463714075, "pbr_median": 1.224647249677839, "psr_median": 113.39688091353831}], "rankings": [{"rank": 15, "grade": "B", "ticker": "6408.T", "company_name": "小倉クラッチ", "price": 3960.0, "per": 5.353304584105011, "pbr": 0.3330511089634735, "psr": 14.197655291411044, "final_score": 60.54, "size_bucket": "2,000-1兆"}, {"rank": 19, "grade": "C", "ticker": "6317.T", "company_name": "北川鉄工所", "price": 1791.0, "per": 5.1203613700040025, "pbr": 0.3829365524805885, "psr": 28.925558176353523, "final_score": 59.06, "size_bucket": "1兆以上"}, {"rank": 22, "grade": "C", "ticker": "6138.T", "company_name": "ダイジェット工業", "price": 1185.0, "per": 9.794197867592365, "pbr": 0.4094987113749411, "psr": 38.93532230953588, "final_score": 58.49, "size_bucket": "2,000-1兆"}]}, {"sector": "水産・農林業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 57.46913580246914, "pbr_median": 2.003020667042457, "psr_median": 59.18991811352255}, {"label": "2,000-1兆", "count": 2, "per_median": 76.2899973221028, "pbr_median": 2.204393714041436, "psr_median": 61.53752062394994}, {"label": "1兆以上", "count": 8, "per_median": 10.82180480261989, "pbr_median": 1.0183030294279254, "psr_median": 77.84020613881354}], "rankings": [{"rank": 73, "grade": "C", "ticker": "1333.T", "company_name": "マルハニチロ", "price": 1492.0, "per": 10.288236105364776, "pbr": 0.9421142761885036, "psr": 20.7292808974682, "final_score": 35.93, "size_bucket": "1兆以上"}, {"rank": 78, "grade": "C", "ticker": "1376.T", "company_name": "カネコ種苗", "price": 1512.0, "per": 13.00421432871764, "pbr": 0.6585988309870751, "psr": 25.411257913126637, "final_score": 34.65, "size_bucket": "1兆以上"}, {"rank": 81, "grade": "C", "ticker": "1301.T", "company_name": "極洋", "price": 5240.0, "per": 9.090909090909092, "pbr": 0.8411993769345378, "psr": 19.163428586135808, "final_score": 31.64, "size_bucket": "1兆以上"}]}, {"sector": "精密機器", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "1兆以上", "count": 30, "per_median": 21.90836342981866, "pbr_median": 1.4723535439746547, "psr_median": 154.11463495448442}], "rankings": [{"rank": 26, "grade": "C", "ticker": "6376.T", "company_name": "日機装", "price": 2350.0, "per": 11.415525114155251, "pbr": 0.9809245652312748, "psr": 71.1246097058224, "final_score": 56.18, "size_bucket": "1兆以上"}, {"rank": 40, "grade": "C", "ticker": "5187.T", "company_name": "クリエートメディック", "price": 1196.0, "per": 14.814814814814817, "pbr": 0.6147150235632193, "psr": 73.64846901707321, "final_score": 50.63, "size_bucket": "1兆以上"}, {"rank": 65, "grade": "C", "ticker": "7743.T", "company_name": "シード", "price": 532.0, "per": 11.710323574730356, "pbr": 0.866738894907909, "psr": 47.969369545985664, "final_score": 41.74, "size_bucket": "1兆以上"}]}, {"sector": "繊維製品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 2540.0, "pbr_median": 1.1524866942235008, "psr_median": 52.545129997769926}, {"label": "2,000-1兆", "count": 11, "per_median": 10.308090987618774, "pbr_median": 0.5658577256016697, "psr_median": 42.64980312021908}, {"label": "1兆以上", "count": 28, "per_median": 20.6888786445162, "pbr_median": 1.0301512081975641, "psr_median": 96.6270143836937}], "rankings": [{"rank": 9, "grade": "B", "ticker": "3551.T", "company_name": "ダイニック", "price": 1230.0, "per": 6.184322992608981, "pbr": 0.3590988196159044, "psr": 22.74238071885689, "final_score": 64.25, "size_bucket": "1兆以上"}, {"rank": 25, "grade": "C", "ticker": "3577.T", "company_name": "東海染工", "price": 1000.0, "per": 9.891196834817013, "pbr": 0.4126517372019158, "psr": 22.417686628533534, "final_score": 56.31, "size_bucket": "2,000-1兆"}, {"rank": 42, "grade": "C", "ticker": "3204.T", "company_name": "トーア紡コーポレーション", "price": 519.0, "per": 5.770513675783856, "pbr": 0.3278638815293239, "psr": 26.22334527476121, "final_score": 49.25, "size_bucket": "2,000-1兆"}]}, {"sector": "証券、商品先物取引業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 2, "per_median": 360.38229981938593, "pbr_median": 2.8956456451832486, "psr_median": 919.5018573759221}, {"label": "1兆以上", "count": 19, "per_median": 15.723636363636365, "pbr_median": 1.2841737380221063, "psr_median": 289.39873157414144}], "rankings": [{"rank": 45, "grade": "C", "ticker": "8473.T", "company_name": "ＳＢＩホールディングス", "price": 3355.0, "per": 7.782056040081648, "pbr": 1.2619324078159315, "psr": 113.67660479945248, "final_score": 47.97, "size_bucket": "1兆以上"}, {"rank": 57, "grade": "C", "ticker": "7148.T", "company_name": "ＦＰＧ", "price": 2043.0, "per": 9.45176960444136, "pbr": 3.0603623900486543, "psr": 146.46413040369185, "final_score": 43.39, "size_bucket": "1兆以上"}, {"rank": 77, "grade": "C", "ticker": "8604.T", "company_name": "野村ホールディングス", "price": 1404.5, "per": 11.904560094931345, "pbr": 1.128369845008821, "psr": 201.66872249750216, "final_score": 34.87, "size_bucket": "1兆以上"}]}, {"sector": "輸送用機器", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 6300.0, "pbr_median": 0.6425902711832943, "psr_median": 37.5407530614856}, {"label": "2,000-1兆", "count": 1, "per_median": 15.674198124632364, "pbr_median": 0.6260045611272725, "psr_median": 98.36487398419804}, {"label": "1兆以上", "count": 43, "per_median": 13.5501054267007, "pbr_median": 0.9232741954929976, "psr_median": 46.29677719176926}], "rankings": [{"rank": 61, "grade": "C", "ticker": "7241.T", "company_name": "フタバ産業", "price": 1120.0, "per": 9.107171897869572, "pbr": 0.763336927378033, "psr": 14.606226694102345, "final_score": 42.57, "size_bucket": "1兆以上"}, {"rank": 82, "grade": "C", "ticker": "7294.T", "company_name": "ヨロズ", "price": 1053.0, "per": 10530.0, "pbr": 0.428108994191866, "psr": 12.68202033130314, "final_score": 31.33, "size_bucket": "1兆以上"}, {"rank": 84, "grade": "C", "ticker": "7201.T", "company_name": "日産自動車", "price": 445.0, "per": 4450.0, "pbr": 0.3177602259882164, "psr": 12.890339754352066, "final_score": 28.58, "size_bucket": "1兆以上"}]}, {"sector": "金属製品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 13100.0, "pbr_median": 0.4463891716209617, "psr_median": 15.689337081103565}, {"label": "2,000-1兆", "count": 31, "per_median": 14.512635379061372, "pbr_median": 0.5233706503776513, "psr_median": 39.64857927312294}, {"label": "1兆以上", "count": 52, "per_median": 13.783674019482154, "pbr_median": 0.7432297653937169, "psr_median": 64.88300162195713}], "rankings": [{"rank": 31, "grade": "C", "ticker": "5994.T", "company_name": "ファインシンター", "price": 1598.0, "per": 3.631075461837352, "pbr": 0.3898305456871398, "psr": 14.868322210730843, "final_score": 54.46, "size_bucket": "2,000-1兆"}, {"rank": 48, "grade": "C", "ticker": "5940.T", "company_name": "不二サッシ", "price": 1015.0, "per": 5.753642083782099, "pbr": 0.5301720107831241, "psr": 12.269325530951802, "final_score": 47.48, "size_bucket": "1兆以上"}, {"rank": 55, "grade": "C", "ticker": "5915.T", "company_name": "駒井ハルテック", "price": 2100.0, "per": 6.12369871402327, "pbr": 0.2874830299451906, "psr": 28.69530404100293, "final_score": 44.77, "size_bucket": "2,000-1兆"}]}, {"sector": "鉄鋼", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 11, "per_median": 9.3721251149954, "pbr_median": 0.478625917119525, "psr_median": 27.3857316788048}, {"label": "1兆以上", "count": 26, "per_median": 15.063876443927493, "pbr_median": 0.7425153544629317, "psr_median": 69.21099969771203}], "rankings": [{"rank": 34, "grade": "C", "ticker": "5491.T", "company_name": "日本金属", "price": 1015.0, "per": 5.3247298289791205, "pbr": 0.2292462676336116, "psr": 13.237127517222223, "final_score": 53.26, "size_bucket": "2,000-1兆"}, {"rank": 51, "grade": "C", "ticker": "5603.T", "company_name": "虹技", "price": 1377.0, "per": 5.017490161783996, "pbr": 0.305015004877582, "psr": 17.452683416821404, "final_score": 46.72, "size_bucket": "2,000-1兆"}, {"rank": 59, "grade": "C", "ticker": "5408.T", "company_name": "中山製鋼所", "price": 620.0, "per": 8.012406306539157, "pbr": 0.3132820999198099, "psr": 22.50151497720352, "final_score": 43.05, "size_bucket": "1兆以上"}]}, {"sector": "銀行業", "buckets": [{"label": "0-500億", "count": 1, "per_median": 13.986447099970851, "pbr_median": 1.4340829862994455, "psr_median": 0.0039393024612826}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "1兆以上", "count": 65, "per_median": 16.666666666666668, "pbr_median": 0.8177142013513773, "psr_median": 265.1376063014848}], "rankings": [{"rank": 66, "grade": "C", "ticker": "8713.T", "company_name": "フィデアホールディングス", "price": 2184.0, "per": 9.813525050550435, "pbr": 0.4603237399533395, "psr": 82.8984275963752, "final_score": 41.67, "size_bucket": "1兆以上"}, {"rank": 74, "grade": "C", "ticker": "8551.T", "company_name": "北日本銀行", "price": 5210.0, "per": 11.350762527233115, "pbr": 0.4569554540352367, "psr": 164.33894072486518, "final_score": 35.66, "size_bucket": "1兆以上"}, {"rank": 76, "grade": "C", "ticker": "8558.T", "company_name": "東和銀行", "price": 1234.0, "per": 7.209628417854639, "pbr": 0.4996495569760431, "psr": 107.4425261507864, "final_score": 35.02, "size_bucket": "1兆以上"}]}, {"sector": "陸運業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "1兆以上", "count": 36, "per_median": 14.245074515523836, "pbr_median": 1.1819626596628843, "psr_median": 92.70215723312626}], "rankings": [{"rank": 44, "grade": "C", "ticker": "9031.T", "company_name": "西日本鉄道", "price": 3134.0, "per": 8.591008771929824, "pbr": 0.8827214183029216, "psr": 50.3142974546572, "final_score": 48.1, "size_bucket": "1兆以上"}, {"rank": 79, "grade": "C", "ticker": "9048.T", "company_name": "名古屋鉄道", "price": 1804.5, "per": 10.764137437365784, "pbr": 0.733843546751873, "psr": 50.62278899757987, "final_score": 33.43, "size_bucket": "1兆以上"}, {"rank": 80, "grade": "C", "ticker": "9081.T", "company_name": "神奈川中央交通", "price": 3645.0, "per": 14.204434745333383, "pbr": 0.7060808965309636, "psr": 35.730352335535315, "final_score": 32.14, "size_bucket": "1兆以上"}]}, {"sector": "電気・ガス業", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "1兆以上", "count": 22, "per_median": 10.499760835255081, "pbr_median": 0.7747206482469029, "psr_median": 45.01158064371782}], "rankings": [{"rank": 50, "grade": "C", "ticker": "9505.T", "company_name": "北陸電力", "price": 1076.5, "per": 3.255216208043544, "pbr": 0.507570174582451, "psr": 27.60639969415017, "final_score": 46.8, "size_bucket": "1兆以上"}, {"rank": 53, "grade": "C", "ticker": "9506.T", "company_name": "東北電力", "price": 1301.0, "per": 3.957294074704952, "pbr": 0.5941903619674324, "psr": 26.549516571637064, "final_score": 45.6, "size_bucket": "1兆以上"}, {"rank": 58, "grade": "C", "ticker": "9504.T", "company_name": "中国電力", "price": 1078.0, "per": 3.4746172441579373, "pbr": 0.5106294289287203, "psr": 26.03626644495335, "final_score": 43.14, "size_bucket": "1兆以上"}]}, {"sector": "電気機器", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 4, "per_median": 2035.0, "pbr_median": 0.9152902509370714, "psr_median": 52.08436806283004}, {"label": "2,000-1兆", "count": 46, "per_median": 61.32534787402044, "pbr_median": 0.8082482564675272, "psr_median": 63.07266592960933}, {"label": "1兆以上", "count": 167, "per_median": 21.59872007584736, "pbr_median": 1.3597704767535592, "psr_median": 111.82982321001003}], "rankings": [{"rank": 3, "grade": "B", "ticker": "3856.T", "company_name": "Ａｂａｌａｎｃｅ", "price": 489.0, "per": 1.374020062378825, "pbr": 0.2490959447282078, "psr": 9.597405413818333, "final_score": 65.87, "size_bucket": "2,000-1兆"}, {"rank": 16, "grade": "B", "ticker": "6699.T", "company_name": "ダイヤモンドエレクトリックホールディングス", "price": 654.0, "per": 2.9299762555441062, "pbr": 0.4436172031224139, "psr": 5.829152849525699, "final_score": 60.47, "size_bucket": "2,000-1兆"}, {"rank": 30, "grade": "C", "ticker": "6899.T", "company_name": "ＡＳＴＩ", "price": 2645.0, "per": 9.149083362158422, "pbr": 0.3310105031071812, "psr": 13.1839223073141, "final_score": 54.59, "size_bucket": "2,000-1兆"}]}, {"sector": "非鉄金属", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "2,000-1兆", "count": 4, "per_median": 18.965203258746172, "pbr_median": 1.1520557672891196, "psr_median": 52.970972035916546}, {"label": "1兆以上", "count": 26, "per_median": 26.32054631370515, "pbr_median": 1.533567433752224, "psr_median": 91.30230871722411}], "rankings": [{"rank": 12, "grade": "B", "ticker": "5851.T", "company_name": "リョービ", "price": 2960.0, "per": 8.547008547008547, "pbr": 0.5246454876500047, "psr": 30.46026672497738, "final_score": 62.24, "size_bucket": "1兆以上"}, {"rank": 17, "grade": "C", "ticker": "5757.T", "company_name": "ＣＫサンエツ", "price": 4330.0, "per": 8.445978894805625, "pbr": 0.6935760283465965, "psr": 26.690706350613564, "final_score": 59.77, "size_bucket": "1兆以上"}, {"rank": 27, "grade": "C", "ticker": "5852.T", "company_name": "アーレスティ", "price": 939.0, "per": 12.5, "pbr": 0.4415980676910112, "psr": 14.045627142177525, "final_score": 56.11, "size_bucket": "1兆以上"}]}, {"sector": "食料品", "buckets": [{"label": "0-500億", "count": 0, "per_median": null, "pbr_median": null, "psr_median": null}, {"label": "500-2,000億", "count": 1, "per_median": 36.059479553903344, "pbr_median": 1.0298661174047374, "psr_median": 24.06492530446365}, {"label": "2,000-1兆", "count": 14, "per_median": 26.074352286629406, "pbr_median": 0.7934446775509467, "psr_median": 24.52547946996998}, {"label": "1兆以上", "count": 104, "per_median": 18.58814468582355, "pbr_median": 1.2658237565149884, "psr_median": 75.15656158683825}], "rankings": [{"rank": 4, "grade": "B", "ticker": "4404.T", "company_name": "ミヨシ油脂", "price": 2305.0, "per": 2.5647587680256363, "pbr": 0.5516437908004004, "psr": 39.5365156806317, "final_score": 65.75, "size_bucket": "1兆以上"}, {"rank": 14, "grade": "B", "ticker": "2286.T", "company_name": "林兼産業", "price": 859.0, "per": 4.697069116360455, "pbr": 0.53477833469155, "psr": 15.505507296309816, "final_score": 60.85, "size_bucket": "2,000-1兆"}, {"rank": 37, "grade": "C", "ticker": "2060.T", "company_name": "フィード・ワン", "price": 1256.0, "per": 9.29337772844987, "pbr": 0.8105908600717527, "psr": 16.597790475714586, "final_score": 52.82, "size_bucket": "1兆以上"}]}];
    const sizeBuckets = ["0-500億", "500-2,000億", "2,000-1兆", "1兆以上"];

    const candidateLabels = timeseries.map(item => item.date);
    const candidateCounts = timeseries.map(item => item.total_candidates);
    const recommendationCounts = timeseries.map(item => item.total_recommendations);

    new Chart(document.getElementById('candidatesChart'), {
      type: 'line',
      data: {
        labels: candidateLabels,
        datasets: [
          {
            label: 'Candidates',
            data: candidateCounts,
            borderColor: '#0f766e',
            backgroundColor: 'rgba(15, 118, 110, 0.2)',
            tension: 0.3,
            fill: true
          },
          {
            label: 'Recommendations',
            data: recommendationCounts,
            borderColor: '#ea580c',
            backgroundColor: 'rgba(234, 88, 12, 0.2)',
            tension: 0.3,
            fill: true
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' }
        }
      }
    });

    const returnLabels = returnSummary.map(item => item.horizon);
    const avgReturns = returnSummary.map(item => item.avg);
    const winRates = returnSummary.map(item => item.win_rate);

    new Chart(document.getElementById('returnsChart'), {
      type: 'bar',
      data: {
        labels: returnLabels,
        datasets: [
          {
            label: 'Average return (%)',
            data: avgReturns,
            backgroundColor: 'rgba(30, 64, 175, 0.6)'
          },
          {
            label: 'Win rate (%)',
            data: winRates,
            backgroundColor: 'rgba(16, 185, 129, 0.6)'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' }
        }
      }
    });

    const metricLabels = { per: 'PER', pbr: 'PBR', psr: 'PSR' };

    const formatValue = (value) => {
      if (value === null || value === undefined || Number.isNaN(value)) return '-';
      return Number(value).toFixed(2);
    };

    const colorScale = (value, min, max) => {
      if (value === null || value === undefined || Number.isNaN(value)) return '#f1f5f9';
      if (min === null || max === null) return '#e2e8f0';
      if (max === min) return 'hsl(200, 70%, 85%)';
      const ratio = (value - min) / (max - min);
      const hue = 120 - Math.round(80 * ratio);
      return `hsl(${hue}, 70%, 85%)`;
    };

    const slugify = (text, index) => {
      const safe = text
        .toString()
        .trim()
        .replace(/\s+/g, '-')
        .replace(/[^0-9A-Za-z぀-ヿ一-鿿\-]/g, '')
        .toLowerCase();
      return `sector-${index}-${safe || 'item'}`;
    };

    const highlightBucket = (section, bucketLabel) => {
      section.querySelectorAll('.heatmap td').forEach(cell => cell.classList.remove('highlight'));
      if (!bucketLabel) return;
      section.querySelectorAll(`.heatmap td[data-bucket="${bucketLabel}"]`)
        .forEach(cell => cell.classList.add('highlight'));
    };

    const renderSectorPages = () => {
      const nav = document.getElementById('sectorNav');
      const container = document.getElementById('sectorSections');

      if (!sectorPages || sectorPages.length === 0) {
        container.innerHTML = '<div class="sector-section">業種データがありません。</div>';
        return;
      }

      sectorPages.forEach((sectorData, index) => {
        const sectionId = slugify(sectorData.sector, index);

        const navLink = document.createElement('a');
        navLink.href = `#${sectionId}`;
        navLink.textContent = sectorData.sector;
        nav.appendChild(navLink);

        const section = document.createElement('div');
        section.className = 'sector-section';
        section.id = sectionId;

        const header = document.createElement('h3');
        header.textContent = sectorData.sector;
        section.appendChild(header);

        const meta = document.createElement('div');
        meta.className = 'sector-meta';
        meta.textContent = '規模帯ごとの中央値とランキングを表示しています。';
        section.appendChild(meta);

        const tabs = document.createElement('div');
        tabs.className = 'metric-tabs';

        const heatmapWrap = document.createElement('div');

        ['per', 'pbr', 'psr'].forEach((metricKey, metricIndex) => {
          const button = document.createElement('button');
          button.className = 'metric-tab' + (metricIndex === 0 ? ' active' : '');
          button.textContent = metricLabels[metricKey];
          button.dataset.metric = metricKey;
          tabs.appendChild(button);

          const panel = document.createElement('div');
          panel.dataset.metric = metricKey;
          panel.style.display = metricIndex === 0 ? 'block' : 'none';

          const values = sectorData.buckets
            .map(bucket => bucket[`${metricKey}_median`])
            .filter(value => value !== null && value !== undefined && !Number.isNaN(value));
          const minVal = values.length ? Math.min(...values) : null;
          const maxVal = values.length ? Math.max(...values) : null;

          const table = document.createElement('table');
          table.className = 'heatmap';

          const thead = document.createElement('thead');
          const headRow = document.createElement('tr');
          const labelCell = document.createElement('th');
          labelCell.textContent = '規模帯';
          headRow.appendChild(labelCell);
          sizeBuckets.forEach(bucketLabel => {
            const th = document.createElement('th');
            th.textContent = bucketLabel;
            headRow.appendChild(th);
          });
          thead.appendChild(headRow);
          table.appendChild(thead);

          const tbody = document.createElement('tbody');
          const bodyRow = document.createElement('tr');
          const metricCell = document.createElement('td');
          metricCell.textContent = metricLabels[metricKey];
          bodyRow.appendChild(metricCell);

          sizeBuckets.forEach(bucketLabel => {
            const bucket = sectorData.buckets.find(item => item.label === bucketLabel);
            const value = bucket ? bucket[`${metricKey}_median`] : null;
            const count = bucket ? bucket.count : 0;
            const cell = document.createElement('td');
            cell.dataset.bucket = bucketLabel;
            cell.style.background = colorScale(value, minVal, maxVal);
            cell.innerHTML = `<div>${formatValue(value)}</div><div style="font-size:11px;color:#6b7280">n=${count}</div>`;
            bodyRow.appendChild(cell);
          });
          tbody.appendChild(bodyRow);
          table.appendChild(tbody);
          panel.appendChild(table);
          heatmapWrap.appendChild(panel);
        });

        section.appendChild(tabs);
        section.appendChild(heatmapWrap);

        const rankingTitle = document.createElement('h4');
        rankingTitle.textContent = 'Sector ranking';
        rankingTitle.style.margin = '12px 0 8px';
        section.appendChild(rankingTitle);

        const rankingTable = document.createElement('table');
        rankingTable.className = 'table ranking-table';
        const head = document.createElement('thead');
        head.innerHTML = `
          <tr>
            <th>Rank</th>
            <th>Grade</th>
            <th>Ticker</th>
            <th>Name</th>
            <th>Price</th>
            <th>PER</th>
            <th>PBR</th>
            <th>PSR</th>
            <th>Score</th>
            <th>Size</th>
          </tr>`;
        rankingTable.appendChild(head);

        const body = document.createElement('tbody');
        if (!sectorData.rankings || sectorData.rankings.length === 0) {
          const emptyRow = document.createElement('tr');
          emptyRow.innerHTML = '<td colspan="10">No ranking data</td>';
          body.appendChild(emptyRow);
        } else {
          sectorData.rankings.forEach(row => {
            const tr = document.createElement('tr');
            tr.dataset.bucket = row.size_bucket || '';
            tr.innerHTML = `
              <td>${row.rank ?? '-'}</td>
              <td>${row.grade ?? '-'}</td>
              <td>${row.ticker ?? '-'}</td>
              <td>${row.company_name ?? '-'}</td>
              <td>${formatValue(row.price)}</td>
              <td>${formatValue(row.per)}</td>
              <td>${formatValue(row.pbr)}</td>
              <td>${formatValue(row.psr)}</td>
              <td>${formatValue(row.final_score)}</td>
              <td>${row.size_bucket ?? '-'}</td>`;

            tr.addEventListener('click', () => {
              section.querySelectorAll('.ranking-table tr').forEach(r => r.classList.remove('selected'));
              tr.classList.add('selected');
              highlightBucket(section, tr.dataset.bucket);
            });

            body.appendChild(tr);
          });
        }
        rankingTable.appendChild(body);
        section.appendChild(rankingTable);

        tabs.querySelectorAll('.metric-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            tabs.querySelectorAll('.metric-tab').forEach(btn => btn.classList.remove('active'));
            tab.classList.add('active');
            const targetMetric = tab.dataset.metric;
            heatmapWrap.querySelectorAll('div[data-metric]').forEach(panel => {
              panel.style.display = panel.dataset.metric === targetMetric ? 'block' : 'none';
            });
          });
        });

        container.appendChild(section);
      });
    };

    renderSectorPages();
  </script>
</body>
</html>
